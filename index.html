<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CureCode - Technical Architecture & Data Flow</title>
    <meta name="description" content="CureCode is a Swiss medical AI documentation platform. View the complete technical architecture, data flow, and deployment details.">
    <meta name="keywords" content="CureCode, Medical AI, Healthcare, Swiss, Documentation, Architecture, NestJS, React, OpenAI, Azure">
    <meta name="author" content="CureCode">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="CureCode - Technical Architecture">
    <meta property="og:description" content="Swiss medical AI documentation platform - Complete technical architecture documentation">
    <meta property="og:image" content="https://brasdor.github.io/curecode-architecture/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè•</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #333;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2a5298;
        }

        h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.2em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 15px 25px;
            background: #f5f5f5;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: #2a5298;
            color: white;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .architecture-layer {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #2a5298;
        }

        .architecture-layer h2 {
            color: #1e3c72;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .service-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            position: relative;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-color: #2a5298;
        }

        .service-card h3 {
            color: #2a5298;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .service-card .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .tech-badge {
            background: #e3f2fd;
            color: #1976d2;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .api-endpoint {
            background: #f5f5f5;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border-left: 3px solid #4caf50;
        }

        .api-endpoint .method {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
            color: white;
        }

        .method.GET { background: #4caf50; }
        .method.POST { background: #2196f3; }
        .method.PATCH { background: #ff9800; }
        .method.DELETE { background: #f44336; }

        .data-flow {
            position: relative;
            padding: 20px;
        }

        .flow-step {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #2a5298;
            position: relative;
            transition: all 0.3s;
        }

        .flow-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-left-color: #1e3c72;
        }

        .flow-step::after {
            content: '‚Üì';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2em;
            color: #2a5298;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .flow-step h3 {
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .flow-step .details {
            color: #666;
            line-height: 1.6;
        }

        .flow-step .code {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .database-schema {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .database-schema h3 {
            color: #1e3c72;
            margin-bottom: 15px;
        }

        .schema-table {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .schema-table .table-name {
            font-weight: bold;
            color: #2a5298;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .schema-field {
            padding: 5px 0;
            border-bottom: 1px solid #f0f0f0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .schema-field:last-child {
            border-bottom: none;
        }

        .field-name {
            color: #1976d2;
            font-weight: 600;
        }

        .field-type {
            color: #f57c00;
            margin-left: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-card .label {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .highlight {
            background: #fff3e0;
            padding: 3px 8px;
            border-radius: 4px;
            color: #e65100;
            font-weight: 600;
        }

        .success {
            color: #4caf50;
            font-weight: 600;
        }

        .azure-deployment {
            background: #0078d4;
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .azure-deployment h3 {
            margin-bottom: 15px;
        }

        .deployment-item {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #d32f2f;
        }

        .info-box {
            background: #e8f5e9;
            border-left: 5px solid #4caf50;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 5px solid #ff9800;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• CureCode Technical Architecture</h1>
            <p class="subtitle">Complete Technical Documentation - Production System</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">üìä Overview</button>
            <button class="tab" onclick="showTab('architecture')">üèóÔ∏è Architecture</button>
            <button class="tab" onclick="showTab('dataflow')">üîÑ Data Flow</button>
            <button class="tab" onclick="showTab('database')">üíæ Database</button>
            <button class="tab" onclick="showTab('deployment')">‚òÅÔ∏è Azure Deployment</button>
        </div>

        <!-- OVERVIEW TAB -->
        <div class="content-section active" id="overview">
            <h2>System Overview</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="number">3</div>
                    <div class="label">Microservices</div>
                </div>
                <div class="stat-card">
                    <div class="number">20</div>
                    <div class="label">Document Types</div>
                </div>
                <div class="stat-card">
                    <div class="number">6</div>
                    <div class="label">Medical Specialties</div>
                </div>
            </div>

            <div class="architecture-layer">
                <h2>Tech Stack (TypeScript Full-Stack)</h2>
                <div class="service-grid">
                    <div class="service-card">
                        <h3>Frontend</h3>
                        <p><strong>React 18 + TypeScript SPA</strong></p>
                        <div class="tech-stack">
                            <span class="tech-badge">React 18</span>
                            <span class="tech-badge">TypeScript</span>
                            <span class="tech-badge">Vite</span>
                            <span class="tech-badge">TanStack Router</span>
                            <span class="tech-badge">TanStack Query</span>
                            <span class="tech-badge">Tailwind CSS</span>
                            <span class="tech-badge">TipTap Editor</span>
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>Backend</h3>
                        <p><strong>2x NestJS Microservices</strong></p>
                        <div class="tech-stack">
                            <span class="tech-badge">NestJS</span>
                            <span class="tech-badge">TypeScript</span>
                            <span class="tech-badge">Prisma ORM</span>
                            <span class="tech-badge">PostgreSQL</span>
                            <span class="tech-badge">JWT Auth</span>
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>AI Services</h3>
                        <p><strong>Intelligent Processing</strong></p>
                        <div class="tech-stack">
                            <span class="tech-badge">Speech-to-Text</span>
                            <span class="tech-badge">PDF/Word Extraction</span>
                            <span class="tech-badge">AI Text Generation</span>
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>Infrastructure</h3>
                        <p><strong>Azure Switzerland North</strong></p>
                        <div class="tech-stack">
                            <span class="tech-badge">Azure App Service</span>
                            <span class="tech-badge">Azure Blob Storage</span>
                            <span class="tech-badge">Docker</span>
                            <span class="tech-badge">GitHub Actions</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <strong>‚úÖ Production Status:</strong> Live system with real doctors as customers<br>
                <strong>‚úÖ Swiss Compliance:</strong> ICD-10-GM, TARMED, FADP, GDPR<br>
                <strong>‚úÖ Data Residency:</strong> All data remains in Switzerland (Azure Switzerland North)
            </div>

            <div class="architecture-layer">
                <h2>‚ú® Key Features & Differentiators</h2>
                <div class="service-grid">
                    <div class="service-card">
                        <h3>üá®üá≠ Swiss Data Sovereignty</h3>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>100% Swiss-hosted infrastructure</li>
                            <li>Azure Switzerland North (Z√ºrich)</li>
                            <li>FADP & GDPR compliant by design</li>
                            <li>No data leaves Switzerland</li>
                        </ul>
                    </div>
                    <div class="service-card">
                        <h3>üéØ Medical Domain Expertise</h3>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>20 Swiss medical document types</li>
                            <li>ICD-10-GM diagnosis coding</li>
                            <li>TARMED billing code integration</li>
                            <li>Swiss AHV number validation</li>
                        </ul>
                    </div>
                    <div class="service-card">
                        <h3>‚ö° Efficiency Gains</h3>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Audio ‚Üí Document in ~3-5 minutes</li>
                            <li>AI-assisted medical terminology</li>
                            <li>Rich-text editor with auto-save</li>
                            <li>Multi-specialty support</li>
                        </ul>
                    </div>
                    <div class="service-card">
                        <h3>üîí Enterprise Security</h3>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>JWT-based authentication</li>
                            <li>Role-based access control</li>
                            <li>Complete audit trail</li>
                            <li>Encrypted storage at rest</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ARCHITECTURE TAB -->
        <div class="content-section" id="architecture">
            <h2>Three-Tier Microservices Architecture</h2>

            <!-- Visual Architecture Diagram -->
            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 16px; padding: 30px; margin-bottom: 30px; text-align: center;">
                <svg viewBox="0 0 800 400" style="max-width: 100%; height: auto;">
                    <!-- Layer Labels (Left Side) -->
                    <text x="30" y="65" fill="#1e3c72" font-weight="bold" font-size="13" text-anchor="start">PRESENTATION</text>
                    <text x="30" y="80" fill="#666" font-size="10" text-anchor="start">Layer 1</text>
                    <line x1="100" y1="60" x2="240" y2="60" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
                    
                    <text x="30" y="195" fill="#1e3c72" font-weight="bold" font-size="13" text-anchor="start">BUSINESS</text>
                    <text x="30" y="210" fill="#666" font-size="10" text-anchor="start">Layer 2</text>
                    <line x1="85" y1="195" x2="100" y2="195" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
                    
                    <text x="30" y="330" fill="#1e3c72" font-weight="bold" font-size="13" text-anchor="start">DATA</text>
                    <text x="30" y="345" fill="#666" font-size="10" text-anchor="start">Layer 3</text>
                    <line x1="60" y1="330" x2="100" y2="330" stroke="#ccc" stroke-width="1" stroke-dasharray="4,4"/>
                    
                    <!-- Layer 1: Frontend -->
                    <rect x="250" y="20" width="300" height="80" rx="12" fill="#4CAF50" stroke="#388E3C" stroke-width="2"/>
                    <text x="400" y="50" text-anchor="middle" fill="white" font-weight="bold" font-size="16">üéØ Frontend</text>
                    <text x="400" y="75" text-anchor="middle" fill="white" font-size="12">React SPA ‚Ä¢ TipTap Editor ‚Ä¢ Tailwind</text>
                    
                    <!-- Arrow 1 -->
                    <path d="M400 100 L400 140" stroke="#2a5298" stroke-width="3" marker-end="url(#arrowhead)"/>
                    <text x="420" y="125" fill="#666" font-size="11">REST API</text>
                    
                    <!-- Layer 2: Backend Services -->
                    <rect x="100" y="150" width="250" height="90" rx="12" fill="#2196F3" stroke="#1976D2" stroke-width="2"/>
                    <text x="225" y="180" text-anchor="middle" fill="white" font-weight="bold" font-size="14">‚öôÔ∏è App Service</text>
                    <text x="225" y="200" text-anchor="middle" fill="white" font-size="11">Business Logic ‚Ä¢ Auth</text>
                    <text x="225" y="220" text-anchor="middle" fill="white" font-size="11">Patient ‚Ä¢ Document CRUD</text>
                    
                    <rect x="450" y="150" width="250" height="90" rx="12" fill="#9C27B0" stroke="#7B1FA2" stroke-width="2"/>
                    <text x="575" y="180" text-anchor="middle" fill="white" font-weight="bold" font-size="14">üß† AI Service</text>
                    <text x="575" y="200" text-anchor="middle" fill="white" font-size="11">Speech-to-Text ‚Ä¢ LLM</text>
                    <text x="575" y="220" text-anchor="middle" fill="white" font-size="11">Document Generation</text>
                    
                    <!-- Arrows 2 -->
                    <path d="M225 240 L225 280" stroke="#2a5298" stroke-width="3" marker-end="url(#arrowhead)"/>
                    <path d="M575 240 L575 280" stroke="#2a5298" stroke-width="3" marker-end="url(#arrowhead)"/>
                    <path d="M350 195 L450 195" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
                    <text x="400" y="188" text-anchor="middle" fill="#666" font-size="10">Internal API</text>
                    
                    <!-- Layer 3: Data -->
                    <rect x="100" y="290" width="250" height="80" rx="12" fill="#FF9800" stroke="#F57C00" stroke-width="2"/>
                    <text x="225" y="320" text-anchor="middle" fill="white" font-weight="bold" font-size="14">üóÑÔ∏è PostgreSQL</text>
                    <text x="225" y="345" text-anchor="middle" fill="white" font-size="11">pgvector ‚Ä¢ Prisma ORM</text>
                    
                    <rect x="450" y="290" width="250" height="80" rx="12" fill="#00BCD4" stroke="#0097A7" stroke-width="2"/>
                    <text x="575" y="320" text-anchor="middle" fill="white" font-weight="bold" font-size="14">‚òÅÔ∏è Azure Blob</text>
                    <text x="575" y="345" text-anchor="middle" fill="white" font-size="11">Audio ‚Ä¢ Documents ‚Ä¢ Assets</text>
                    
                    <!-- Arrow marker definition -->
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#2a5298"/>
                        </marker>
                    </defs>
                </svg>
            </div>

            <div class="architecture-layer">
                <h2>üé® Layer 1: Frontend (curecode-app-client)</h2>
                <div class="service-card">
                    <h3>React SPA</h3>
                    <p><strong>Responsibilities:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Patient Management (AHV Validation)</li>
                        <li>Consultation Management</li>
                        <li>Document Generation Wizard (3-Step)</li>
                        <li>Rich-Text Editor (TipTap/ProseMirror)</li>
                        <li>File Upload UI (Audio up to 50MB)</li>
                    </ul>
                    <div class="tech-stack">
                        <span class="tech-badge">React 18</span>
                        <span class="tech-badge">TypeScript</span>
                        <span class="tech-badge">TanStack Router</span>
                        <span class="tech-badge">TanStack Query</span>
                        <span class="tech-badge">Tailwind CSS</span>
                        <span class="tech-badge">TipTap Editor</span>
                    </div>
                    <div class="code" style="margin-top: 15px;">
                        Production: https://[redacted]-client-prod.azurewebsites.net<br>
                        Staging: https://[redacted]-client-staging.azurewebsites.net<br>
                        Deployment: Azure App Service (Docker Container)<br>
                        Build: Vite
                    </div>
                </div>
            </div>

            <div style="text-align: center; font-size: 2em; color: #2a5298; margin: 20px 0;">‚Üì</div>

            <div class="architecture-layer">
                <h2>‚öôÔ∏è Layer 2: Backend Services</h2>
                <div class="service-grid">
                    <div class="service-card">
                        <h3>curecode-app-service</h3>
                        <p><strong>Main Business Logic API</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Patient CRUD</li>
                            <li>Consultation CRUD</li>
                            <li>Document CRUD</li>
                            <li>User Management</li>
                            <li>JWT Authentication</li>
                            <li>Organisation Management</li>
                        </ul>
                        <div class="tech-stack">
                            <span class="tech-badge">NestJS</span>
                            <span class="tech-badge">TypeScript</span>
                            <span class="tech-badge">Prisma ORM</span>
                            <span class="tech-badge">PostgreSQL</span>
                        </div>
                        <div class="code" style="margin-top: 15px;">
                            Deployment: Azure App Service (Docker)<br>
                            Database: PostgreSQL with Prisma ORM<br>
                            API Docs: OpenAPI/Swagger
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>curecode-ai-service</h3>
                        <p><strong>AI Processing Service</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Audio Transcription (Whisper)</li>
                            <li>Document Extraction (PDF/DOCX)</li>
                            <li>AI Document Generation (LLM)</li>
                            <li>Azure Blob Storage Management</li>
                            <li>Retry Logic & Error Handling</li>
                        </ul>
                        <div class="tech-stack">
                            <span class="tech-badge">NestJS</span>
                            <span class="tech-badge">Speech-to-Text</span>
                            <span class="tech-badge">Document Extraction</span>
                            <span class="tech-badge">Azure Blob</span>
                        </div>
                        <div class="code" style="margin-top: 15px;">
                            Deployment: Azure App Service (Docker)<br>
                            Storage: Azure Blob for audio/documents<br>
                            Max Upload: 50MB
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; font-size: 2em; color: #2a5298; margin: 20px 0;">‚Üì</div>

            <div class="architecture-layer">
                <h2>üíæ Layer 3: Data & Storage</h2>
                <div class="service-grid">
                    <div class="service-card">
                        <h3>PostgreSQL Database</h3>
                        <p><strong>Schema Isolation:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Business logic schema (patients, docs, users)</li>
                            <li>AI processing schema (transcriptions, completions)</li>
                        </ul>
                        <div class="tech-stack">
                            <span class="tech-badge">PostgreSQL 15</span>
                            <span class="tech-badge">pgvector extension</span>
                            <span class="tech-badge">Prisma Migrations</span>
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>Azure Blob Storage</h3>
                        <p><strong>File Storage:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Audio files (MP3, M4A, WAV, WEBM)</li>
                            <li>Uploaded documents (PDF, DOCX)</li>
                            <li>Organisation logos</li>
                        </ul>
                        <div class="tech-stack">
                            <span class="tech-badge">Azure Blob</span>
                            <span class="tech-badge">Encrypted</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <strong>üîí Security:</strong> All services communicate via JWT Tokens. No API keys in the frontend. CORS is strictly configured for Production & Staging domains.
            </div>
        </div>

        <!-- DATA FLOW TAB -->
        <div class="content-section" id="dataflow">
            <h2>Complete Data Flow: Audio ‚Üí Final Document</h2>
            
            <div class="data-flow">
                <div class="flow-step">
                    <h3>Step 1: User Authentication</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>User logs in with email/password</li>
                            <li>Backend verifies credentials securely</li>
                            <li>JWT token generated and returned</li>
                            <li>Frontend stores token for subsequent requests</li>
                        </ol>
                        <div class="code">
                            Authentication: JWT-based<br>
                            Password Storage: bcrypt hashed<br>
                            Session: Secure token management
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 2: Patient Selection/Creation</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>Frontend fetches patient list for organisation</li>
                            <li>User selects existing patient or creates new</li>
                            <li>Swiss AHV number validation applied</li>
                            <li>Patient record loaded with insurance data</li>
                        </ol>
                        <div class="code">
                            Validation: Swiss AHV format (756.XXXX.XXXX.XX)<br>
                            Data: Patient demographics + insurance info
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 3: Consultation Creation</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>User creates new consultation for patient</li>
                            <li>Consultation record linked to user and patient</li>
                            <li>Consultation date recorded</li>
                            <li>Ready for audio upload</li>
                        </ol>
                        <div class="code">
                            Relationships: User ‚Üí Consultation ‚Üí Patient<br>
                            Tracking: Full audit trail maintained
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 4: Audio Upload & Transcription</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>User uploads audio file (up to 50MB)</li>
                            <li>File securely stored in cloud storage</li>
                            <li>Transcription job queued</li>
                            <li>Whisper API processes audio to text</li>
                            <li>Frontend polls for completion status</li>
                            <li>Transcription text ready for document generation</li>
                        </ol>
                        <div class="code">
                            Transcription: Whisper API (configurable vendor)<br>
                            Language: German (Swiss medical terminology)<br>
                            Reliability: Automatic retry with backoff
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 5: Document Generation Wizard</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li><strong>Step 1:</strong> Select Medical Specialty</li>
                            <li><strong>Step 2:</strong> Select Document Type (20 types available)</li>
                            <li><strong>Step 3:</strong> Select Sections to include</li>
                            <li>User clicks "Generate with AI"</li>
                        </ol>
                        <div class="code">
                            UI: 3-step wizard interface<br>
                            Customization: Specialty-specific templates
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 6: AI Document Generation</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>Backend retrieves transcription text</li>
                            <li>Loads appropriate prompt template</li>
                            <li>Constructs prompt with:
                                <ul style="margin-left: 20px;">
                                    <li>Transcription content</li>
                                    <li>Selected document sections</li>
                                    <li>Doctor and organisation context</li>
                                    <li>Swiss medical coding guidelines</li>
                                </ul>
                            </li>
                            <li>LLM generates structured medical document</li>
                            <li>Document formatted for rich-text editor</li>
                            <li>Saved to database for review</li>
                        </ol>
                        <div class="code">
                            AI Model: LLM (configurable vendor)<br>
                            Compliance: ICD-10-GM + TARMED guidelines<br>
                            Processing: ~10-20 seconds
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 7: Document Review & Edit</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>Document opens in rich-text editor</li>
                            <li>Doctor reviews AI-generated content</li>
                            <li>Full editing capabilities (Word-like experience)</li>
                            <li>Auto-save ensures no work is lost</li>
                            <li>Document progresses through workflow states</li>
                        </ol>
                        <div class="code">
                            Editor: TipTap (ProseMirror-based)<br>
                            Features: Formatting, tables, lists, headings<br>
                            Save: Automatic with manual option
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <h3>Step 8: Document Finalization</h3>
                    <div class="details">
                        <p><strong>Flow:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>Doctor clicks "Approve"</li>
                            <li>Document status updated to approved</li>
                            <li>Audit trail entry recorded</li>
                            <li>Document linked to consultation record</li>
                            <li>Ready for export (PDF, print)</li>
                        </ol>
                        <div class="code">
                            Workflow: Draft ‚Üí Pending ‚Üí Approved<br>
                            Audit: Complete history of all changes<br>
                            Export: PDF generation available
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <strong>‚ö° Performance Metrics:</strong><br>
                50MB Audio: ~2-4 minutes transcription<br>
                Document Generation: ~10-20 seconds<br>
                Total Time: Audio ‚Üí Final Document = ~3-5 minutes
            </div>
        </div>

        <!-- DATABASE TAB -->
        <div class="content-section" id="database">
            <h2>Data Management Capabilities</h2>

            <!-- Visual Capabilities Diagram -->
            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 16px; padding: 30px; margin-bottom: 30px;">
                <svg viewBox="0 0 800 280" style="max-width: 100%; height: auto;">
                    <!-- Central Database -->
                    <ellipse cx="400" cy="140" rx="100" ry="60" fill="#1e3c72" stroke="#2a5298" stroke-width="3"/>
                    <text x="400" y="130" text-anchor="middle" fill="white" font-weight="bold" font-size="16">üóÑÔ∏è PostgreSQL</text>
                    <text x="400" y="155" text-anchor="middle" fill="white" font-size="12">Switzerland North</text>
                    
                    <!-- Capability bubbles -->
                    <circle cx="150" cy="60" r="50" fill="#4CAF50" stroke="#388E3C" stroke-width="2"/>
                    <text x="150" y="55" text-anchor="middle" fill="white" font-weight="bold" font-size="11">üè¢ Multi-</text>
                    <text x="150" y="72" text-anchor="middle" fill="white" font-size="11">Tenant</text>
                    
                    <circle cx="650" cy="60" r="50" fill="#2196F3" stroke="#1976D2" stroke-width="2"/>
                    <text x="650" y="55" text-anchor="middle" fill="white" font-weight="bold" font-size="11">üîç Semantic</text>
                    <text x="650" y="72" text-anchor="middle" fill="white" font-size="11">Search</text>
                    
                    <circle cx="150" cy="220" r="50" fill="#FF9800" stroke="#F57C00" stroke-width="2"/>
                    <text x="150" y="215" text-anchor="middle" fill="white" font-weight="bold" font-size="11">üìù Audit</text>
                    <text x="150" y="232" text-anchor="middle" fill="white" font-size="11">Trail</text>
                    
                    <circle cx="650" cy="220" r="50" fill="#9C27B0" stroke="#7B1FA2" stroke-width="2"/>
                    <text x="650" y="215" text-anchor="middle" fill="white" font-weight="bold" font-size="11">üîê Role-Based</text>
                    <text x="650" y="232" text-anchor="middle" fill="white" font-size="11">Access</text>
                    
                    <circle cx="80" cy="140" r="45" fill="#E91E63" stroke="#C2185B" stroke-width="2"/>
                    <text x="80" y="135" text-anchor="middle" fill="white" font-weight="bold" font-size="10">üóëÔ∏è Soft</text>
                    <text x="80" y="150" text-anchor="middle" fill="white" font-size="10">Delete</text>
                    
                    <circle cx="720" cy="140" r="45" fill="#00BCD4" stroke="#0097A7" stroke-width="2"/>
                    <text x="720" y="135" text-anchor="middle" fill="white" font-weight="bold" font-size="10">üîí Encrypted</text>
                    <text x="720" y="150" text-anchor="middle" fill="white" font-size="10">Storage</text>
                    
                    <!-- Connection lines -->
                    <line x1="200" y1="75" x2="310" y2="110" stroke="#666" stroke-width="2"/>
                    <line x1="600" y1="75" x2="490" y2="110" stroke="#666" stroke-width="2"/>
                    <line x1="200" y1="205" x2="310" y2="170" stroke="#666" stroke-width="2"/>
                    <line x1="600" y1="205" x2="490" y2="170" stroke="#666" stroke-width="2"/>
                    <line x1="125" y1="140" x2="300" y2="140" stroke="#666" stroke-width="2"/>
                    <line x1="675" y1="140" x2="500" y2="140" stroke="#666" stroke-width="2"/>
                </svg>
            </div>

            <div class="service-grid">
                <div class="service-card">
                    <h3>üè¢ Multi-Tenant Isolation</h3>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        Complete data separation between medical practices. Each organisation's data is logically isolated with enforced access boundaries.
                    </p>
                    <div class="tech-stack" style="margin-top: 15px;">
                        <span class="tech-badge">Row-Level Security</span>
                        <span class="tech-badge">Organisation Scoping</span>
                    </div>
                </div>
                <div class="service-card">
                    <h3>üîç AI-Powered Search</h3>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        Semantic search across medical documents using vector embeddings. Find relevant patient history using natural language queries.
                    </p>
                    <div class="tech-stack" style="margin-top: 15px;">
                        <span class="tech-badge">Vector Similarity</span>
                        <span class="tech-badge">Natural Language</span>
                    </div>
                </div>
                <div class="service-card">
                    <h3>üìù Complete Audit Trail</h3>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        Every document modification is logged with timestamp, user, and action type. Full history for compliance and accountability.
                    </p>
                    <div class="tech-stack" style="margin-top: 15px;">
                        <span class="tech-badge">Immutable Logs</span>
                        <span class="tech-badge">User Attribution</span>
                    </div>
                </div>
                <div class="service-card">
                    <h3>üîê Access Control</h3>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        Role-based permissions from System Admin to standard users. Specialty-specific access and organisation-level administration.
                    </p>
                    <div class="tech-stack" style="margin-top: 15px;">
                        <span class="tech-badge">4 Permission Levels</span>
                        <span class="tech-badge">JWT Claims</span>
                    </div>
                </div>
                <div class="service-card">
                    <h3>üóëÔ∏è Data Recovery</h3>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        Soft delete pattern ensures no accidental data loss. Records can be recovered within retention period. Hard delete for GDPR compliance.
                    </p>
                    <div class="tech-stack" style="margin-top: 15px;">
                        <span class="tech-badge">Soft Delete</span>
                        <span class="tech-badge">GDPR Right to Erasure</span>
                    </div>
                </div>
                <div class="service-card">
                    <h3>üá®üá≠ Swiss Data Residency</h3>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        All data stored exclusively in Azure Switzerland North (Z√ºrich). Encrypted at rest and in transit. FADP & GDPR compliant.
                    </p>
                    <div class="tech-stack" style="margin-top: 15px;">
                        <span class="tech-badge">AES-256 Encryption</span>
                        <span class="tech-badge">TLS 1.3</span>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <strong>üõ†Ô∏è Technology Foundation:</strong> PostgreSQL database with modern ORM ‚Ä¢ Automated schema migrations ‚Ä¢ Service-level isolation
            </div>
        </div>

        <!-- DEPLOYMENT TAB -->
        <div class="content-section" id="deployment">
            <h2>Azure Switzerland North Deployment</h2>

            <div class="azure-deployment">
                <h3>üåç Azure Resources</h3>
                <div class="deployment-item">
                    <strong>Region:</strong> Switzerland North (Z√ºrich)<br>
                    <strong>Environments:</strong> Production + Staging<br>
                    <strong>Compliance:</strong> FADP & GDPR compliant hosting
                </div>
                <div class="deployment-item">
                    <strong>Compute:</strong> Azure App Service (Linux)<br>
                    <strong>Runtime:</strong> Docker Containers<br>
                    <strong>Scaling:</strong> Horizontal scaling ready
                </div>
            </div>

            <div class="architecture-layer">
                <h2>üöÄ Production Environment</h2>
                <div class="service-grid">
                    <div class="service-card">
                        <h3>Frontend App</h3>
                        <p><strong>React SPA</strong></p>
                        <div class="code" style="margin-top: 10px;">
                            Runtime: Docker Container<br>
                            Image Tag: :prod<br>
                            Status: ‚úÖ Running
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>Backend API</h3>
                        <p><strong>Main Business Logic</strong></p>
                        <div class="code" style="margin-top: 10px;">
                            Runtime: Docker Container<br>
                            Image Tag: :prod<br>
                            Status: ‚úÖ Running
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>AI Service</h3>
                        <p><strong>AI Processing</strong></p>
                        <div class="code" style="margin-top: 10px;">
                            Runtime: Docker Container<br>
                            Image Tag: :prod<br>
                            Status: ‚úÖ Running
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-layer">
                <h2>üß™ Staging Environment</h2>
                <div class="service-grid">
                    <div class="service-card">
                        <h3>Frontend App</h3>
                        <p><strong>React SPA</strong></p>
                        <div class="code" style="margin-top: 10px;">
                            Runtime: Docker Container<br>
                            Image Tag: :staging<br>
                            Status: ‚úÖ Running
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>Backend API</h3>
                        <p><strong>Main Business Logic</strong></p>
                        <div class="code" style="margin-top: 10px;">
                            Runtime: Docker Container<br>
                            Image Tag: :staging<br>
                            Status: ‚úÖ Running
                        </div>
                    </div>
                    <div class="service-card">
                        <h3>AI Service</h3>
                        <p><strong>AI Processing</strong></p>
                        <div class="code" style="margin-top: 10px;">
                            Runtime: Docker Container<br>
                            Image Tag: :staging<br>
                            Status: ‚úÖ Running
                        </div>
                    </div>
                </div>
            </div>

            <div class="architecture-layer">
                <h2>Database</h2>
                <div class="service-card">
                    <h3>Azure Database for PostgreSQL Flexible Server</h3>
                    <div class="code" style="margin-top: 10px;">
                        Hosting: Azure Database for PostgreSQL Flexible Server<br>
                        Version: PostgreSQL 15<br>
                        Extensions: pgvector (semantic search), pg_trgm<br>
                        Architecture: Multi-schema isolation<br>
                        Compute: Production tier (auto-scaling)<br>
                        Backup: Automated with retention policy
                    </div>
                </div>
            </div>

            <div class="architecture-layer">
                <h2>Storage</h2>
                <div class="service-card">
                    <h3>Azure Blob Storage</h3>
                    <div class="code" style="margin-top: 10px;">
                        Purpose: Audio files, uploaded documents, organisation assets<br>
                        Encryption: Server-side encryption at rest<br>
                        Access: Private containers with SAS tokens<br>
                        Region: Switzerland North (data residency)
                    </div>
                </div>
            </div>

            <div class="architecture-layer">
                <h2>CI/CD Pipeline (GitHub Actions)</h2>
                <div class="flow-step">
                    <h3>Build & Deploy Workflow</h3>
                    <div class="details">
                        <p><strong>Production Deployment:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>Create/push <code>prod</code> Git tag</li>
                            <li>GitHub Actions triggers production build</li>
                            <li>Run tests (npm test)</li>
                            <li>Build Docker image with <code>:prod</code> tag</li>
                            <li>Push to Azure Container Registry</li>
                            <li>Deploy to Production App Services</li>
                            <li>Health check verification</li>
                        </ol>
                        <p style="margin-top: 15px;"><strong>Staging Deployment:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>Create/push <code>staging</code> Git tag</li>
                            <li>GitHub Actions triggers staging build</li>
                            <li>Build Docker image with <code>:staging</code> tag</li>
                            <li>Deploy to Staging App Services</li>
                        </ol>
                        <div class="code" style="margin-top: 10px;">
                            Registry: Azure Container Registry<br>
                            <br>
                            Image Tagging Strategy:<br>
                            &nbsp;&nbsp;‚Ä¢ Production: :prod tag<br>
                            &nbsp;&nbsp;‚Ä¢ Staging: :staging tag<br>
                            <br>
                            Services: Frontend, Backend API, AI Service
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <strong>‚úÖ Swiss Data Residency:</strong> All services and databases run in Switzerland (Switzerland North).<br>
                <strong>‚úÖ Compliance:</strong> FADP & GDPR compliant through Swiss Azure deployment.<br>
                <strong>‚úÖ Security:</strong> HTTPS enforced, JWT tokens, CORS configured, Azure AD authentication.
            </div>

            <div class="warning-box">
                <strong>üîí Secrets Management:</strong><br>
                All sensitive configuration (API keys, connection strings) stored securely in Azure App Service.<br>
                No secrets in code, Git repository, or Docker images.
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected content section
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }
    </script>
</body>
</html>